<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Quantum Computer Outreach Project: dspic33e/qcomp-sim-c.X/io.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Quantum Computer Outreach Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_cae82029997ea84f6afb13b39521d0ca.html">dspic33e</a></li><li class="navelem"><a class="el" href="dir_6662ae699bb746dfe74afbdc036e2b7f.html">qcomp-sim-c.X</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">io.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains all the functions for reading buttons and writing to LEDs.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="io_8h_source.html">io.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="time_8h_source.html">time.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="spi_8h_source.html">spi.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for io.c:</div>
<div class="dyncontent">
<div class="center"><img src="io_8c__incl.png" border="0" usemap="#dspic33e_2qcomp-sim-c_8X_2io_8c" alt=""/></div>
<map name="dspic33e_2qcomp-sim-c_8X_2io_8c" id="dspic33e_2qcomp-sim-c_8X_2io_8c">
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a562ef4b1f4490498c24ed25975a52f0d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a562ef4b1f4490498c24ed25975a52f0d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>DISPLAY_CHIP_NUM</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a562ef4b1f4490498c24ed25975a52f0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af281425e62298bac2df0fbe8690a4844"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af281425e62298bac2df0fbe8690a4844"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>PERIOD</b>&#160;&#160;&#160;500000</td></tr>
<tr class="separator:af281425e62298bac2df0fbe8690a4844"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23acb072acb9b41623cfca614f10a9a7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a23acb072acb9b41623cfca614f10a9a7">BTN_CHIP_NUM</a>&#160;&#160;&#160;2</td></tr>
<tr class="memdesc:a23acb072acb9b41623cfca614f10a9a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read external buttons.  <a href="#a23acb072acb9b41623cfca614f10a9a7">More...</a><br /></td></tr>
<tr class="separator:a23acb072acb9b41623cfca614f10a9a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af3f93a224b1c0993b55cb3534237300f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#af3f93a224b1c0993b55cb3534237300f">led_color_int</a> (int device, int R, int G, int B)</td></tr>
<tr class="memdesc:af3f93a224b1c0993b55cb3534237300f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes led number &amp; RGB -&gt; returns integer for sending via SPI to set the <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a>.  <a href="#af3f93a224b1c0993b55cb3534237300f">More...</a><br /></td></tr>
<tr class="separator:af3f93a224b1c0993b55cb3534237300f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd4a9c9edd862d4e50bf6a3740d9b82"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#accd4a9c9edd862d4e50bf6a3740d9b82">setup_io</a> (void)</td></tr>
<tr class="memdesc:accd4a9c9edd862d4e50bf6a3740d9b82"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set up LEDs and buttons on port D.  <a href="#accd4a9c9edd862d4e50bf6a3740d9b82">More...</a><br /></td></tr>
<tr class="separator:accd4a9c9edd862d4e50bf6a3740d9b82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64653c452ab199760e9cdd6bdbbeeb76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a64653c452ab199760e9cdd6bdbbeeb76">__attribute__</a> ((__interrupt__, no_auto_psv))</td></tr>
<tr class="memdesc:a64653c452ab199760e9cdd6bdbbeeb76"><td class="mdescLeft">&#160;</td><td class="mdescRight">The max value for isr_counter.  <a href="#a64653c452ab199760e9cdd6bdbbeeb76">More...</a><br /></td></tr>
<tr class="separator:a64653c452ab199760e9cdd6bdbbeeb76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f0891d14ef2e6230b477700b9e3daad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3f0891d14ef2e6230b477700b9e3daad">setup_external_leds</a> (void)</td></tr>
<tr class="memdesc:a3f0891d14ef2e6230b477700b9e3daad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set external variable RGB LEDs.  <a href="#a3f0891d14ef2e6230b477700b9e3daad">More...</a><br /></td></tr>
<tr class="separator:a3f0891d14ef2e6230b477700b9e3daad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a8e4ae99d58990da0bdfca60d5767a7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1a8e4ae99d58990da0bdfca60d5767a7"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a1a8e4ae99d58990da0bdfca60d5767a7">stop_external_leds</a> (void)</td></tr>
<tr class="memdesc:a1a8e4ae99d58990da0bdfca60d5767a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop LEDs flashing. <br /></td></tr>
<tr class="separator:a1a8e4ae99d58990da0bdfca60d5767a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89d0c0b5eee8cda66adde23080acd0bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a89d0c0b5eee8cda66adde23080acd0bd">set_strobe</a> (int color, int state)</td></tr>
<tr class="memdesc:a89d0c0b5eee8cda66adde23080acd0bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set an <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> strobing.  <a href="#a89d0c0b5eee8cda66adde23080acd0bd">More...</a><br /></td></tr>
<tr class="separator:a89d0c0b5eee8cda66adde23080acd0bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8abb07633ea7d3ab2bd8c9d082feb65a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a8abb07633ea7d3ab2bd8c9d082feb65a">toggle_strobe</a> (int color)</td></tr>
<tr class="memdesc:a8abb07633ea7d3ab2bd8c9d082feb65a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Toggle <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> strobe.  <a href="#a8abb07633ea7d3ab2bd8c9d082feb65a">More...</a><br /></td></tr>
<tr class="separator:a8abb07633ea7d3ab2bd8c9d082feb65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31fb0fd759d90940706a83347642f59e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a31fb0fd759d90940706a83347642f59e">set_led</a> (int color, int state)</td></tr>
<tr class="memdesc:a31fb0fd759d90940706a83347642f59e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn a particular <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> on or off.  <a href="#a31fb0fd759d90940706a83347642f59e">More...</a><br /></td></tr>
<tr class="separator:a31fb0fd759d90940706a83347642f59e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c2b76dada8dc8a2d65249074843867c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5c2b76dada8dc8a2d65249074843867c">read_btn</a> (int btn)</td></tr>
<tr class="memdesc:a5c2b76dada8dc8a2d65249074843867c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the state of a push button.  <a href="#a5c2b76dada8dc8a2d65249074843867c">More...</a><br /></td></tr>
<tr class="separator:a5c2b76dada8dc8a2d65249074843867c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf53abfd4d628a2791bf1783de96b27"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4bf53abfd4d628a2791bf1783de96b27"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a4bf53abfd4d628a2791bf1783de96b27">leds_off</a> (void)</td></tr>
<tr class="memdesc:a4bf53abfd4d628a2791bf1783de96b27"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn all the LEDs off. <br /></td></tr>
<tr class="separator:a4bf53abfd4d628a2791bf1783de96b27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12adda62b67a14e911149c76376ce295"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a12adda62b67a14e911149c76376ce295">flash_led</a> (int color, int number)</td></tr>
<tr class="memdesc:a12adda62b67a14e911149c76376ce295"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> a number of times.  <a href="#a12adda62b67a14e911149c76376ce295">More...</a><br /></td></tr>
<tr class="separator:a12adda62b67a14e911149c76376ce295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24a09a687c0efdba91ec54b2853b2260"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a24a09a687c0efdba91ec54b2853b2260">flash_all</a> (int number)</td></tr>
<tr class="memdesc:a24a09a687c0efdba91ec54b2853b2260"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flash all the LEDs a number of times.  <a href="#a24a09a687c0efdba91ec54b2853b2260">More...</a><br /></td></tr>
<tr class="separator:a24a09a687c0efdba91ec54b2853b2260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4d6ef42e52f47c63a522f62f933585b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ab4d6ef42e52f47c63a522f62f933585b">update_display_buffer</a> (int n, bool R, bool G, bool B)</td></tr>
<tr class="separator:ab4d6ef42e52f47c63a522f62f933585b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a207068fff8b8f61fdf49a807efe94f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a7a207068fff8b8f61fdf49a807efe94f">write_display_driver</a> (void)</td></tr>
<tr class="memdesc:a7a207068fff8b8f61fdf49a807efe94f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn on an <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> via the external display driver.  <a href="#a7a207068fff8b8f61fdf49a807efe94f">More...</a><br /></td></tr>
<tr class="separator:a7a207068fff8b8f61fdf49a807efe94f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf115833d4313aa7a9f099a4d7bea685"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#aaf115833d4313aa7a9f099a4d7bea685">TLC591x_mode_switch</a> (int mode)</td></tr>
<tr class="memdesc:aaf115833d4313aa7a9f099a4d7bea685"><td class="mdescLeft">&#160;</td><td class="mdescRight">Switch between normal and special mode.  <a href="#aaf115833d4313aa7a9f099a4d7bea685">More...</a><br /></td></tr>
<tr class="separator:aaf115833d4313aa7a9f099a4d7bea685"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2a143e27a01fa3dadbb9030771478ef"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#af2a143e27a01fa3dadbb9030771478ef">set_external_led</a> (int index, unsigned _Fract R, unsigned _Fract G, unsigned _Fract B)</td></tr>
<tr class="memdesc:af2a143e27a01fa3dadbb9030771478ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates color properties of global led array.  <a href="#af2a143e27a01fa3dadbb9030771478ef">More...</a><br /></td></tr>
<tr class="separator:af2a143e27a01fa3dadbb9030771478ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb7c3f9a532bae5bd32330fb1f2f4b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#aedb7c3f9a532bae5bd32330fb1f2f4b8">read_external_buttons</a> (void)</td></tr>
<tr class="memdesc:aedb7c3f9a532bae5bd32330fb1f2f4b8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the buttons array (see declaration above)  <a href="#aedb7c3f9a532bae5bd32330fb1f2f4b8">More...</a><br /></td></tr>
<tr class="separator:aedb7c3f9a532bae5bd32330fb1f2f4b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1bf99f09184b0112291c5eaa0832fb6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#ae1bf99f09184b0112291c5eaa0832fb6">led_cycle_test</a> (void)</td></tr>
<tr class="memdesc:ae1bf99f09184b0112291c5eaa0832fb6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loop to cycle through LEDs 0 - 15.  <a href="#ae1bf99f09184b0112291c5eaa0832fb6">More...</a><br /></td></tr>
<tr class="separator:ae1bf99f09184b0112291c5eaa0832fb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41666d13a62cc3b7c341ed287382623b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a41666d13a62cc3b7c341ed287382623b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a41666d13a62cc3b7c341ed287382623b">varying_leds</a> (void)</td></tr>
<tr class="memdesc:a41666d13a62cc3b7c341ed287382623b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to test the set_external_led function. <br /></td></tr>
<tr class="separator:a41666d13a62cc3b7c341ed287382623b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a76df059cb7347e382a4fa70f08e80814"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a76df059cb7347e382a4fa70f08e80814">buttons</a> [16]</td></tr>
<tr class="memdesc:a76df059cb7347e382a4fa70f08e80814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains the button states.  <a href="#a76df059cb7347e382a4fa70f08e80814">More...</a><br /></td></tr>
<tr class="separator:a76df059cb7347e382a4fa70f08e80814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3240a0ec7160d6bae6cc4a7bab8494c7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structLED__GLOBAL.html">LED_GLOBAL</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a3240a0ec7160d6bae6cc4a7bab8494c7">led_global</a> = {0}</td></tr>
<tr class="separator:a3240a0ec7160d6bae6cc4a7bab8494c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11ae3bccffd844c51949ca06b0b52279"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11ae3bccffd844c51949ca06b0b52279"></a>
<a class="el" href="structLED.html">LED</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a11ae3bccffd844c51949ca06b0b52279">led</a> [<a class="el" href="io_8h.html#a77440c4104ae0a7368936ff87a3d3260">LED_NUM</a>]</td></tr>
<tr class="memdesc:a11ae3bccffd844c51949ca06b0b52279"><td class="mdescLeft">&#160;</td><td class="mdescRight">The <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> array &ndash; global in this file. <br /></td></tr>
<tr class="separator:a11ae3bccffd844c51949ca06b0b52279"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af88c57a82a9e95871b599e5d4534087d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af88c57a82a9e95871b599e5d4534087d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#af88c57a82a9e95871b599e5d4534087d">display_buf</a> [DISPLAY_CHIP_NUM] = {0}</td></tr>
<tr class="memdesc:af88c57a82a9e95871b599e5d4534087d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display buffer to be written to display driver. <br /></td></tr>
<tr class="separator:af88c57a82a9e95871b599e5d4534087d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a572e88f7f47750764bbe0320524db8dd"><td class="memItemLeft" align="right" valign="top">unsigned _Fract&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a572e88f7f47750764bbe0320524db8dd">isr_counter</a> = 0</td></tr>
<tr class="memdesc:a572e88f7f47750764bbe0320524db8dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter for the interrupt service routine _T5Interrupt.  <a href="#a572e88f7f47750764bbe0320524db8dd">More...</a><br /></td></tr>
<tr class="separator:a572e88f7f47750764bbe0320524db8dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fa193acdb20bc82de0f56d55b6bc985"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5fa193acdb20bc82de0f56d55b6bc985"></a>
unsigned _Fract&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a5fa193acdb20bc82de0f56d55b6bc985">isr_res</a> = 0.01</td></tr>
<tr class="memdesc:a5fa193acdb20bc82de0f56d55b6bc985"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter value. <br /></td></tr>
<tr class="separator:a5fa193acdb20bc82de0f56d55b6bc985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d8c002dfe6a6108d58f3043f6af23b2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d8c002dfe6a6108d58f3043f6af23b2"></a>
const unsigned _Fract&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="io_8c.html#a0d8c002dfe6a6108d58f3043f6af23b2">isr_limit</a> = 0.95</td></tr>
<tr class="memdesc:a0d8c002dfe6a6108d58f3043f6af23b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Counter resolution. <br /></td></tr>
<tr class="separator:a0d8c002dfe6a6108d58f3043f6af23b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains all the functions for reading buttons and writing to LEDs. </p>
<dl class="section author"><dt>Author</dt><dd>J Scott </dd></dl>
<dl class="section date"><dt>Date</dt><dd>8/11/18 </dd></dl>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a23acb072acb9b41623cfca614f10a9a7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BTN_CHIP_NUM&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read external buttons. </p>
<p>The external buttons are interfaced to the microcontroller via a shift register. Data is shifted in a byte at a time using the SPI 3 module. The sequence to read the buttons is as follows:</p>
<p>1) Momentarily bring SH low to latch button data into the shift registers 2) Bring CLK_INH low to enable the clock input on the shift register 3) Start the SPI 3 clock and read data in via the SDI 3 line</p>
<p>The control lines SH and CLK_INH are on port D</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>read buttons </dd></dl>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a64653c452ab199760e9cdd6bdbbeeb76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void __attribute__ </td>
          <td>(</td>
          <td class="paramtype">(__interrupt__, no_auto_psv)&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The max value for isr_counter. </p>
<p>Interrupt service routine for timer 4</p>
<p>Interrupt service routines are automatically called by the microcontroller when an event occurs. In this case, _T5Interrupt is called when the 32 bit timer formed from T4 and T5 reaches its preset period. The silly name and sill attributes are so that the compiler can correctly map the function in the microcontroller memory. More details of interrupts and interrupt vectors can be found in the compiler manual and the dsPIC33E datasheet.</p>
<p>The job of this routine is to control the modulated brightnesses of the RBG LEDs. This routine is set to be called periodically with a very long period on the time scale of microcontroller operations, but very fast in comparison to what the eye can see. For example, once every 100us. </p>
<p>Loop over all the LEDs (the index i).</p>
<p>Decide whether R, G or B should be turned off</p>
<p>Write the display buffer data to the display drivers It's important this line goes here rather than after the the final update_display_buffer below. Otherwise you get a flicker due to the LEDs all coming on at the start of this loop</p>
<p>Reset the counter</p>
<p>Turn on all the LEDs back on </p>

</div>
</div>
<a class="anchor" id="a24a09a687c0efdba91ec54b2853b2260"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flash_all </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flash all the LEDs a number of times. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">number</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a12adda62b67a14e911149c76376ce295"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flash_led </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flash <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> a number of times. </p>
<p>Flash one <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> a number of times. </p>

</div>
</div>
<a class="anchor" id="af3f93a224b1c0993b55cb3534237300f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int led_color_int </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes led number &amp; RGB -&gt; returns integer for sending via SPI to set the <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td>input <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> number to change </td></tr>
    <tr><td class="paramname">R</td><td>red value between 0 &amp; 1 </td></tr>
    <tr><td class="paramname">G</td><td>green value between 0 &amp; 1 </td></tr>
    <tr><td class="paramname">B</td><td>blue value between 0 &amp; 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns int to be sent to <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> Driver </dd></dl>
<p>convention RGB -&gt; 000</p>
<p>Each <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> takes 3 lines, assumes there are no gaps between <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> channels "device" goes between 0 to 2^n -1 </p>

</div>
</div>
<a class="anchor" id="ae1bf99f09184b0112291c5eaa0832fb6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int led_cycle_test </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loop to cycle through LEDs 0 - 15. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>This won't work now: write_display_driver(counter); </dd></dl>

</div>
</div>
<a class="anchor" id="a5c2b76dada8dc8a2d65249074843867c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_btn </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>btn</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read the state of a push button. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">btn</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>How well do you know C </dd></dl>

</div>
</div>
<a class="anchor" id="aedb7c3f9a532bae5bd32330fb1f2f4b8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int read_external_buttons </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update the buttons array (see declaration above) </p>
<p>SH pin</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>How long should this be? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>button remappings... </dd></dl>

</div>
</div>
<a class="anchor" id="af2a143e27a01fa3dadbb9030771478ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_external_led </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned _Fract&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned _Fract&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned _Fract&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates color properties of global led array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">led_index</td><td></td></tr>
    <tr><td class="paramname">R</td><td>red value between 0 &amp; 1 </td></tr>
    <tr><td class="paramname">G</td><td>green value between 0 &amp; 1 </td></tr>
    <tr><td class="paramname">B</td><td>blue value between 0 &amp; 1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful, -1 otherwise</dd></dl>
<p>Use the function to set the RGB level of an <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a>. The <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> is chosen using the </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">led_index.</td><td>The </td></tr>
    <tr><td class="paramname">R</td><td>param G and </td></tr>
    <tr><td class="paramname">B</td><td>are numbers between 0 and 1 (not including 1) indicating the amount of each color. The function returns 0 if successful and -1 otherwise. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a31fb0fd759d90940706a83347642f59e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int set_led </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turn a particular <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> on or off. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">color</td><td></td></tr>
    <tr><td class="paramname">state</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a89d0c0b5eee8cda66adde23080acd0bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_strobe </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>color</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set an <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> strobing. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">color</td><td></td></tr>
    <tr><td class="paramname">state</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a3f0891d14ef2e6230b477700b9e3daad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setup_external_leds </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set external variable RGB LEDs. </p>
<p>Initialise <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> lines</p>
<p>Initialise parameters to zero</p>
<p>Initialise display buffer to zero </p>

</div>
</div>
<a class="anchor" id="accd4a9c9edd862d4e50bf6a3740d9b82"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int setup_io </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set up LEDs and buttons on port D. </p>
<p>&lt; Set port c digital for spi3</p>
<p>Set the OE pin high</p>
<p>Set OE(ED2) pin</p>
<p>Set the SH pin high</p>
<p>Set SH pin</p>
<p>set CLK_INH high while buttons are pressed </p>

</div>
</div>
<a class="anchor" id="aaf115833d4313aa7a9f099a4d7bea685"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int TLC591x_mode_switch </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Switch between normal and special mode. </p>
<p>The mode switch for the TLC591x chip is a bit tricky because it involves synchronising the control lines <a class="el" href="io_8h.html#aa4d6abc7b58eb11e517993df83b7f0f7" title="Control for TLC591x chip on Port D. ">LE(ED1)</a> and OE(ED2) on Port D with the SPI 1 clock. To initiate a mode switch, OE(ED2) must be brought low for one clock cycle, and then the value of <a class="el" href="io_8h.html#aa4d6abc7b58eb11e517993df83b7f0f7" title="Control for TLC591x chip on Port D. ">LE(ED1)</a> two clock cycles later determines the new mode. See the diagrams on page 19 of the datasheet</p>
<p>So long as the timing is not strict, we can probably implement the mode switch by starting a non-blocking transfer of 1 byte to the device (which starts the SPI 1 clock), followed by clearing OE(ED2) momentarily and then setting the value of <a class="el" href="io_8h.html#aa4d6abc7b58eb11e517993df83b7f0f7" title="Control for TLC591x chip on Port D. ">LE(ED1)</a> as required. So long as those two things happen before the SPI 1 clock finishes the procedure will probably work. (The reason is the lack of max timing parameters on page 9 for the setup and hold time for ED1 and ED2, which can therefore presumably be longer than one clock cycle.) </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>mode switcher for <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> Driver </dd></dl>

</div>
</div>
<a class="anchor" id="a8abb07633ea7d3ab2bd8c9d082feb65a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void toggle_strobe </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>color</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Toggle <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> strobe. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">color</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ab4d6ef42e52f47c63a522f62f933585b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_display_buffer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>R</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>G</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>B</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td><a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> number to modify </td></tr>
    <tr><td class="paramname">R</td><td>Intended value of the R led </td></tr>
    <tr><td class="paramname">G</td><td>Intended value of the G led </td></tr>
    <tr><td class="paramname">B</td><td>Intended value of the B led </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 if successful</dd></dl>
<p>Could this get any worse!</p>
<p>This function is supposed to make the display writing process more efficient. It updates a global display buffer which is written periodically to the led display drivers. Instead of the display driver function re-reading the desired state of all the <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> lines every time it is called, this function can be used to update only the lines that have changed.</p>
<p>There are quite a few potential bugs in here, mainly array out of bounds if the DISPLAY_CHIP_NUM is not set correctly or the <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> RGB lines are wrong. (Or if there are just bugs.) </p>
<p>Set or clear the red <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> of the nth <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a></p>
<p>Set or clear the red <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> of the nth <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a></p>
<p>Set or clear the red <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> of the nth <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> </p>

</div>
</div>
<a class="anchor" id="a7a207068fff8b8f61fdf49a807efe94f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int write_display_driver </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turn on an <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> via the external display driver. </p>
<p>Send a byte to the display driver.</p>
<p>On power on, the chip (TLC591x) is in normal mode which means that the clocked bytes sent to the chip set which LEDs are on and which are off (as opposed to setting the current of the LEDs)</p>
<p>To write to the device, use the SPI module to write a byte to the SDI 1 pin on the chip. Then momentarily set the <a class="el" href="io_8h.html#aa4d6abc7b58eb11e517993df83b7f0f7" title="Control for TLC591x chip on Port D. ">LE(ED1)</a> pin to latch the data onto the output register. Finally, bring the OE(ED2) pin low to enable the current sinking to turn on the LEDs. See the timing diagram on page 17 of the datasheet for details.</p>
<p><a class="el" href="io_8h.html#aa4d6abc7b58eb11e517993df83b7f0f7" title="Control for TLC591x chip on Port D. ">LE(ED1)</a> and OE(ED2) will be on Port D </p>
<p>Set <a class="el" href="io_8h.html#aa4d6abc7b58eb11e517993df83b7f0f7" title="Control for TLC591x chip on Port D. ">LE(ED1)</a> pin</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>How long should this be? </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a76df059cb7347e382a4fa70f08e80814"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int buttons[16]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Contains the button states. </p>
<p>Each entry in the array is either 1 if the button is pressed or 0 if not. The array is accessed globally using `extern buttons;' in a *.c file. Read buttons array us updated by calling read_external_buttons </p>

</div>
</div>
<a class="anchor" id="a572e88f7f47750764bbe0320524db8dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned _Fract isr_counter = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Counter for the interrupt service routine _T5Interrupt. </p>
<p>These variables are for keeping track of the interrupt based <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> pulsing. The type is _Fract because it is easier to directly compare two _Fracts than attempt multiplication of integers and _Fracts (which isn't supported) The limit is not 1 because _Fract types do not go up to 1.</p>
<p>It's probably a good idea to make sure the isr_res counter doesn't overflow (by ensuring that isr_res + isr_limit does not exceed 0.999..., the max value of unsigned _Fract). </p>

</div>
</div>
<a class="anchor" id="a3240a0ec7160d6bae6cc4a7bab8494c7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structLED__GLOBAL.html">LED_GLOBAL</a> led_global = {0}</td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">led_global</td><td>Global <a class="el" href="structLED.html" title="Each LED has the following type. ">LED</a> strobing state parameter </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
