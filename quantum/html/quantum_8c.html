<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Quantum Computer Outreach Project: dspic33e/qcomp-sim-c.X/quantum.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Quantum Computer Outreach Project
   </div>
   <div id="projectbrief">J Scott, O Thomas, Bristol 2018</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_15ff54b15d1e25f7ce738c9a3fe98b31.html">dspic33e</a></li><li class="navelem"><a class="el" href="dir_41732047a0354d31db2b57d6efa10cab.html">qcomp-sim-c.X</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">quantum.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Description: Contains matrix and vector arithmetic for simulating one qubit.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="quantum_8h_source.html">quantum.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for quantum.c:</div>
<div class="dyncontent">
<div class="center"><img src="quantum_8c__incl.png" border="0" usemap="#dspic33e_2qcomp-sim-c_8X_2quantum_8c" alt=""/></div>
<map name="dspic33e_2qcomp-sim-c_8X_2quantum_8c" id="dspic33e_2qcomp-sim-c_8X_2quantum_8c">
<area shape="rect" id="node2" href="quantum_8h.html" title="Description: Header file containing all the matrix arithmetic for simulating a single qubit..." alt="" coords="41,95,123,121"/>
<area shape="rect" id="node4" href="consts_8h.html" title="header file for (global) constants " alt="" coords="93,169,165,196"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0dc94e50e1ffbc70dd687a48f34230d2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a0dc94e50e1ffbc70dd687a48f34230d2">pow2</a> (int k)</td></tr>
<tr class="memdesc:a0dc94e50e1ffbc70dd687a48f34230d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">A simple function to compute integer powers of 2.  <a href="#a0dc94e50e1ffbc70dd687a48f34230d2">More...</a><br /></td></tr>
<tr class="separator:a0dc94e50e1ffbc70dd687a48f34230d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a112e319d431a2827c78e971f9ca7dd41"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a112e319d431a2827c78e971f9ca7dd41">sign</a> (<a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> a)</td></tr>
<tr class="memdesc:a112e319d431a2827c78e971f9ca7dd41"><td class="mdescLeft">&#160;</td><td class="mdescRight">returns phase quadrant  <a href="#a112e319d431a2827c78e971f9ca7dd41">More...</a><br /></td></tr>
<tr class="separator:a112e319d431a2827c78e971f9ca7dd41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e10038c3eec54100bf1920671368f4a"><td class="memItemLeft" align="right" valign="top"><a id="a8e10038c3eec54100bf1920671368f4a"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>cadd</b> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> a, const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> b, <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> result)</td></tr>
<tr class="separator:a8e10038c3eec54100bf1920671368f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1fd41764e3e5513b916ddcfb010fe39"><td class="memItemLeft" align="right" valign="top"><a id="af1fd41764e3e5513b916ddcfb010fe39"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>cmul</b> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> a, const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> b, <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> result)</td></tr>
<tr class="separator:af1fd41764e3e5513b916ddcfb010fe39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c505ea21f44c1e8e4f15b71b19b8cf3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="consts_8h.html#a66dbef8ee970f4d9747e8bb5533d2a92">Q15</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a4c505ea21f44c1e8e4f15b71b19b8cf3">absolute</a> (<a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> x)</td></tr>
<tr class="memdesc:a4c505ea21f44c1e8e4f15b71b19b8cf3"><td class="mdescLeft">&#160;</td><td class="mdescRight">abs function  <a href="#a4c505ea21f44c1e8e4f15b71b19b8cf3">More...</a><br /></td></tr>
<tr class="separator:a4c505ea21f44c1e8e4f15b71b19b8cf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad005ad233c481de9229e4c1c0dcf5d36"><td class="memItemLeft" align="right" valign="top"><a class="el" href="consts_8h.html#a66dbef8ee970f4d9747e8bb5533d2a92">Q15</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#ad005ad233c481de9229e4c1c0dcf5d36">square_magnitude</a> (<a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> x)</td></tr>
<tr class="memdesc:ad005ad233c481de9229e4c1c0dcf5d36"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the magnitude squared of a complex number.  <a href="#ad005ad233c481de9229e4c1c0dcf5d36">More...</a><br /></td></tr>
<tr class="separator:ad005ad233c481de9229e4c1c0dcf5d36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5699149d9f8da95b284d42ab8d004b21"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a5699149d9f8da95b284d42ab8d004b21">zero_state</a> (<a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> state[])</td></tr>
<tr class="memdesc:a5699149d9f8da95b284d42ab8d004b21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise state to the vacuum (zero apart from the first position) Specify the dimension &ndash; of the matrix, i.e.  <a href="#a5699149d9f8da95b284d42ab8d004b21">More...</a><br /></td></tr>
<tr class="separator:a5699149d9f8da95b284d42ab8d004b21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5cbff6c0e5b92c1cb765c4c219952f7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#ad5cbff6c0e5b92c1cb765c4c219952f7">mat_mul_old</a> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> M[2][2], <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> V[], int i, int j)</td></tr>
<tr class="memdesc:ad5cbff6c0e5b92c1cb765c4c219952f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is an old version of the mat_mul function.  <a href="#ad5cbff6c0e5b92c1cb765c4c219952f7">More...</a><br /></td></tr>
<tr class="separator:ad5cbff6c0e5b92c1cb765c4c219952f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a034aae000da9f5544033abebbef4c5e0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a034aae000da9f5544033abebbef4c5e0">mat_mul</a> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> M[2][2], <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> V[], int i, int j)</td></tr>
<tr class="memdesc:a034aae000da9f5544033abebbef4c5e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This version uses inlined cadd and cmul.  <a href="#a034aae000da9f5544033abebbef4c5e0">More...</a><br /></td></tr>
<tr class="separator:a034aae000da9f5544033abebbef4c5e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a408325d76eec56562e47e72fc131cc76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a408325d76eec56562e47e72fc131cc76">single_qubit_op</a> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> op[2][2], int k, <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> state[])</td></tr>
<tr class="memdesc:a408325d76eec56562e47e72fc131cc76"><td class="mdescLeft">&#160;</td><td class="mdescRight">apply operator  <a href="#a408325d76eec56562e47e72fc131cc76">More...</a><br /></td></tr>
<tr class="separator:a408325d76eec56562e47e72fc131cc76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155da7af383d815ce9f1dc223e47d56e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a155da7af383d815ce9f1dc223e47d56e">single_qubit_op_new</a> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> op[2][2], int k, <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> state[])</td></tr>
<tr class="memdesc:a155da7af383d815ce9f1dc223e47d56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">New function to perform single qubit gates.  <a href="#a155da7af383d815ce9f1dc223e47d56e">More...</a><br /></td></tr>
<tr class="separator:a155da7af383d815ce9f1dc223e47d56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61c576933f0298643e59d33e7fadd3a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a61c576933f0298643e59d33e7fadd3a9">controlled_qubit_op_new</a> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> op[2][2], int ctrl, int targ, <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> state[])</td></tr>
<tr class="memdesc:a61c576933f0298643e59d33e7fadd3a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Efficient controlled qubit operation.  <a href="#a61c576933f0298643e59d33e7fadd3a9">More...</a><br /></td></tr>
<tr class="separator:a61c576933f0298643e59d33e7fadd3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6551e97d523f70c50778a11d51214e31"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="quantum_8c.html#a6551e97d523f70c50778a11d51214e31">controlled_qubit_op</a> (const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> op[2][2], int ctrl, int targ, <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a> state[])</td></tr>
<tr class="memdesc:a6551e97d523f70c50778a11d51214e31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Old controlled qubit operations.  <a href="#a6551e97d523f70c50778a11d51214e31">More...</a><br /></td></tr>
<tr class="separator:a6551e97d523f70c50778a11d51214e31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Description: Contains matrix and vector arithmetic for simulating one qubit. </p>
<dl class="section author"><dt>Authors</dt><dd>J Scott, O Thomas </dd></dl>
<dl class="section date"><dt>Date</dt><dd>Nov 2018 </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000024">Todo:</a></b></dt><dd>split into a complex math and operator files </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a4c505ea21f44c1e8e4f15b71b19b8cf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c505ea21f44c1e8e4f15b71b19b8cf3">&#9670;&nbsp;</a></span>absolute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="consts_8h.html#a66dbef8ee970f4d9747e8bb5533d2a92">Q15</a> absolute </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>abs function </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>A complex number to find the absolute value of </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The absolute value </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000025">Todo:</a></b></dt><dd>Check that the complex part is small </dd></dl>

</div>
</div>
<a id="a6551e97d523f70c50778a11d51214e31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6551e97d523f70c50778a11d51214e31">&#9670;&nbsp;</a></span>controlled_qubit_op()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlled_qubit_op </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>op</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>state</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Old controlled qubit operations. </p>
<p>apply controlled 2x2 op </p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000007">Bug:</a></b></dt><dd>this needs to be a long int for &gt;16 qubits </dd></dl>
<p>ROOT loop: starts at 0, increases in steps of 1</p>
<p>STEP loop: starts at 0, increases in steps of 2^(k+1)</p>
<p>First index is ZERO, second index is ONE </p><dl class="section note"><dt>Note</dt><dd>for 2 qubit case check if the index in the ctrl qubit is a 1 then apply the 2x2 unitary else do nothing</dd>
<dd>
sorry. this checks for the first element of the state vector i.e. the target qubits |0&gt; and checks that the state vector element is one which the control qubit has a |1&gt; state -&gt; (root + step)</dd></dl>
<p>The second element of the state vector to take is then the first +2^(target qubit number). This also needs to be checked that the control qubit is in the |1&gt;. </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000031">Todo:</a></b></dt><dd>This expression can probably be simplified or broken over lines. The condition for the if statement is that root+step and root + step + root_max contain 1 in the ctrl-th bit. </dd></dl>

</div>
</div>
<a id="a61c576933f0298643e59d33e7fadd3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61c576933f0298643e59d33e7fadd3a9">&#9670;&nbsp;</a></span>controlled_qubit_op_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void controlled_qubit_op_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>op</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ctrl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>targ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>state</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Efficient controlled qubit operation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>the operation (ctrl-op is performed) </td></tr>
    <tr><td class="paramname">ctrl</td><td>the index of the ctrl qubit </td></tr>
    <tr><td class="paramname">targ</td><td>the index of the targ qubit </td></tr>
    <tr><td class="paramname">state</td><td>the state vector</td></tr>
  </table>
  </dd>
</dl>
<p>This function is implemented similarly to the single qubit case above. Now there are three ranges of indices to increment through, separated by the two qubit indices. </p>

</div>
</div>
<a id="a034aae000da9f5544033abebbef4c5e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a034aae000da9f5544033abebbef4c5e0">&#9670;&nbsp;</a></span>mat_mul()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mat_mul </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>M</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>V</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This version uses inlined cadd and cmul. </p>
<p>2x2 complex matrix multiplication</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">M</td><td>A 2x2 complex matrix </td></tr>
    <tr><td class="paramname">V</td><td>A Nx1 complex vector </td></tr>
    <tr><td class="paramname">i</td><td>The first index to pick from the vector V </td></tr>
    <tr><td class="paramname">j</td><td>The second index to pick from the vector V </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000028">Todo:</a></b></dt><dd>Is static enough? Or should we declare outside the function? </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000029">Todo:</a></b></dt><dd>Should we use for loops? Or is it better not to..? </dd></dl>
<p>This is necessary because the previous computations use V </p>

</div>
</div>
<a id="ad5cbff6c0e5b92c1cb765c4c219952f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5cbff6c0e5b92c1cb765c4c219952f7">&#9670;&nbsp;</a></span>mat_mul_old()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mat_mul_old </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>M</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>V</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This is an old version of the mat_mul function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">M</td><td>A 2x2 complex matrix </td></tr>
    <tr><td class="paramname">V</td><td>A Nx1 complex vector </td></tr>
    <tr><td class="paramname">i</td><td>The first index to pick from the vector V </td></tr>
    <tr><td class="paramname">j</td><td>The second index to pick from the vector V</td></tr>
  </table>
  </dd>
</dl>
<p>The function uses cadd and cmul </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000027">Todo:</a></b></dt><dd>Should these be outside the function? </dd></dl>

</div>
</div>
<a id="a0dc94e50e1ffbc70dd687a48f34230d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dc94e50e1ffbc70dd687a48f34230d2">&#9670;&nbsp;</a></span>pow2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pow2 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>A simple function to compute integer powers of 2. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">k</td><td>The exponent of 2 to compute </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>2^k </dd></dl>

</div>
</div>
<a id="a112e319d431a2827c78e971f9ca7dd41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a112e319d431a2827c78e971f9ca7dd41">&#9670;&nbsp;</a></span>sign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int sign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>returns phase quadrant </p>
<pre class="fragment">///        Im
//          |
//     1    |   0
//          |
//  ----------------- Re
//          |
//     2    |   3
//          |
/// </pre> 
</div>
</div>
<a id="a408325d76eec56562e47e72fc131cc76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a408325d76eec56562e47e72fc131cc76">&#9670;&nbsp;</a></span>single_qubit_op()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void single_qubit_op </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>op</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>state</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>apply operator </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>state vector containing amplitudes </td></tr>
    <tr><td class="paramname">qubit</td><td>qubit number to apply 2x2 matrix to </td></tr>
    <tr><td class="paramname">N</td><td>total number of qubits in the state </td></tr>
    <tr><td class="paramname">op</td><td>2x2 operator to be applied</td></tr>
  </table>
  </dd>
</dl>
<p>This routine applies a single qubit gate to the state vector </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state.</td><td>Consider the three qubit case, with amplitudes shown in the table below:</td></tr>
  </table>
  </dd>
</dl>
<pre class="fragment">*     index     binary   amplitude 
*      ----------------------------- 
*        0       0 0 0       a0
*        1       0 0 1       a1 
*        2       0 1 0       a2
*        3       0 1 1       a3
*        4       1 0 0       a4
*        5       1 0 1       a5
*        6       1 1 0       a6
*        7       1 1 1       a7
*      -----------------------------
*      Qubit:    2 1 0
* </pre><p>If a single qubit operation is applied to qubit 2, then the 2x2 matrix must be applied to all pairs of (0,1) in the first column, with the numbers in the other columns fixed. In other words, the following indices are paired: </p><pre class="fragment">  (0+0) (1+0) (2+0) (3+0)
  (4+0) (5+0) (6+0) (7+0)
</pre><p>where the top line corresponds to the ZERO amplitude and the bottom row corresponds to the ONE amplitude.</p>
<p>Similarly, for qubit 1 the pairings are: </p><pre class="fragment">  (0+0) (0+4) (1+0) (1+4)
  (2+0) (2+4) (3+0) (3+4)
</pre><p>And for qubit 0 the pairings are: </p><pre class="fragment">  (0+0) (0+2) (0+4) (0+6)
  (1+0) (1+2) (1+4) (1+6)
</pre><p>These numbers are exactly the same as the previous function, which means the same nested loops can be used to perform operation. Now the index </p><pre class="fragment"> root + step 
</pre><p>refers to the ZERO amplitude (the first element in the column vector to be multiplied by the 2x2 matrix), and the index Complex state[], int N root + 2^k + step</p>
<p>corresponds to the ONE entry. </p>
<p>ROOT loop: starts at 0, increases in steps of 1</p>
<p>STEP loop: starts at 0, increases in steps of 2^(k+1)</p>
<p>First index is ZERO, second index is ONE </p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000030">Todo:</a></b></dt><dd>Should we inline mat_mul here? </dd></dl>

</div>
</div>
<a id="a155da7af383d815ce9f1dc223e47d56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a155da7af383d815ce9f1dc223e47d56e">&#9670;&nbsp;</a></span>single_qubit_op_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void single_qubit_op_new </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>op</em>[2][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>state</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>New function to perform single qubit gates. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">op</td><td>the unitary to perform </td></tr>
    <tr><td class="paramname">k</td><td>the index of the qubit to modify </td></tr>
    <tr><td class="paramname">state</td><td>the state vector</td></tr>
  </table>
  </dd>
</dl>
<p>The function computes a single qubit operation acting on </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state.</td><td>It sets the bit position associated with the qubit to zero, and then generates all possible indices in the other bit positions. These correspond to the ZERO states. The ONE states are obtained by changing the kth bit from zero to one. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad005ad233c481de9229e4c1c0dcf5d36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad005ad233c481de9229e4c1c0dcf5d36">&#9670;&nbsp;</a></span>square_magnitude()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="consts_8h.html#a66dbef8ee970f4d9747e8bb5533d2a92">Q15</a> square_magnitude </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute the magnitude squared of a complex number. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">x</td><td>The input complex number x </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value of |x|^2</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000026">Todo:</a></b></dt><dd>Maybe we should inline this </dd></dl>

</div>
</div>
<a id="a5699149d9f8da95b284d42ab8d004b21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5699149d9f8da95b284d42ab8d004b21">&#9670;&nbsp;</a></span>zero_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zero_state </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="consts_8h.html#ab32a0935b29bf7784d29e5669c59e588">Complex</a>&#160;</td>
          <td class="paramname"><em>state</em>[]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise state to the vacuum (zero apart from the first position) Specify the dimension &ndash; of the matrix, i.e. </p>
<p>2^(number of qubits) </p>
<dl class="section note"><dt>Note</dt><dd>oh the clarity! </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
